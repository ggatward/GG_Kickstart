<%#
kind: snippet
name: GatwardIT-snippet_generate_hardened_sshkeys
locations:
- Home
organizations:
- GatwardIT
- MyOrg
%>
echo "++++++++++++++++++++++++++ SSH Key regeneration Snippet +++++++++++++++++++++++++++++"

echo ">>> Creating 384 bit ECDSA keys"
ECDSA_KEY="/etc/ssh/ssh_host_ecdsa_key"
rm -f ${ECDSA_KEY} ${ECDSA_KEY}.pub
ssh-keygen -q -t ecdsa -b 384 -f ${ECDSA_KEY} -C '' -N ''

echo ">>> Creating 4096 bit RSA keys"
RSA_KEY="/etc/ssh/ssh_host_rsa_key"
rm -f ${RSA_KEY} ${RSA_KEY}.pub
ssh-keygen -q -t rsa -b 4096 -f ${RSA_KEY} -C '' -N ''
